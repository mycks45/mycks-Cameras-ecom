{% extends 'adminPanel/baseAdmin.html' %}

{% load static %}

{% block content %}

<link rel="stylesheet" href="{% static '/css/cropper.min.css' %}">
<script src="{% static '/js/cropper.min.js' %}" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/0.8.1/cropper.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>


<div class="mt-3">
    <div class="text-center">
        <h5 style="color:black;"><b>Update Product Information</b></h5>
        <h6 style="color:black;"> {{obj.product_name}} </h6>
        <hr>
        <hr>
    </div>
    <div class="container">
        <form action="" method="POST" enctype="multipart/form-data">
            {% csrf_token %}

            <div class="form-group">
                <label for="" style="color: black;">Product Name:</label>
                {{form.product_name}}
            </div>
            <div class="form-group">
                <label for="" style="color: black;">Slug:</label>
                {{form.slug}}
            </div>
            <div class="form-group">
                <label for="" style="color: black;">Available</label>
                {{form.is_available}}
            </div>
            <div class="form-group">
                <label for="exampleFormControlSelect1" style="color: black;">Brands</label>
                {{form.brand}}
            </div>
            <div class="form-group">
                <label for="exampleFormControlTextarea1" style="color: black;">Description</label>
                {{form.description}}
            </div>
            <div class="form-group">
                <label for="" style="color: black;">Price:</label>
                {{form.price}}
            </div>
            <div class="form-group">
                <label for="" style="color: black;">Stock:</label>
                {{form.stock}}
            </div>

            <div class="form-group">
                <label for="exampleFormControlSelect1" style="color: black;">category</label>
                {{form.category}}
            </div>
            <div class="form-group">
                <label for="exampleFormControlSelect1" style="color: black;">Is offer Available</label>
                {{form.offer_active}}
                <h6 style="color:black;"> {{ form.errors.offer_active }} </h6>
            </div>
            <div class="form-group">
                <label for="exampleFormControlSelect1" style="color: black;">Offer in Percentage</label>
                {{form.offer_discount}}
                <h6 style="color:black;"> {{ form.errors.offer_discount }} </h6>
            </div>


            <div class="row">
                <!-- image crop 1 -->
                <div class="col-md-4">
                    <label for="" style="color: black;">Image</label>
                    <img src="{{obj.Images.url}}" width="250" alt="your new image" />
                    {{form.Images}}
                    <p style="color: black;">Preview before crop:</p>
                    <img id="blah" src="#" alt="your image" />

                    <div class="form-group text-center">
                        <p style="color: black;">Preview:</p>
                        <textarea name="pro_img1" id="pro_img1" style="display: none;"></textarea>
                        <img src="" id="imageview1" style="height: auto;width: 300px;">

                    </div>

                    <div class="row">
                        <div class="modal fade" id="exampleModalCenter1" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="result1"></div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
                                        </button>
                                        <button type="button" id="btnCrop1" class="btn save1 btn-primary">Save changes
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- image crop 2 -->
                <div class="col-md-4">
                    <label for="" style="color: black;">Image</label>
                    <img src="{{obj.Images11.url}}" width="250" alt="your new image" />
                    {{form.Images11}}
                    <p style="color: black;">Preview before crop:</p>
                    <img id="blah11" src="#" alt="your image" />

                    <div class="form-group text-center">
                        <p style="color: black;">Preview:</p>
                        <textarea name="pro_img2" id="pro_img2" style="display: none;"></textarea>
                        <img src="" id="imageview2" style="height: auto;width: 300px;">

                    </div>
                    <div class="row">
                        <div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="box-2">
                                            <div style="max-width: 100%;" class="result2"></div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
                                        </button>
                                        <button type="button" id="btnCrop2" class="btn save2 btn-primary">Save changes
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- image crop 3 -->
                <div class="col-md-4">
                    <label for="" style="color: black;">Image</label>
                    <img src="{{obj.Images22.url}}" width="250" alt="your new image" />
                    {{form.Images22}}
                    <p style="color: black;">Preview before crop:</p>
                    <img id="blah22" src="#" alt="your image" />

                    <div class="form-group text-center">
                        <p style="color: black;">Preview:</p>
                        <textarea name="pro_img3" id="pro_img3" style="display: none;"></textarea>
                        <img src="" id="imageview3" style="height: auto;width: 300px;">
                    </div>

                    <div class="row">
                        <div class="modal fade" id="exampleModalCenter3" tabindex="-1" role="dialog"
                            aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="box-2">
                                            <div style="width:10em;height: 100%" class="result3"></div>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
                                        </button>
                                        <button type="button" id="btnCrop3" class="btn save3 btn-primary">Save changes
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- //////////////////////////////////////////////////////////////////////////////////////////// -->
            <div class="d-flex flex-row-reverse">
                <button type="submit" class="btn btn-warning">Update</button>
                <a href="{% url 'product_mgt' %}" type="button" class="btn btn-dark mr-2">Back</a>
            </div>
        </form>
        <p style="color: black;">
            {{ form.errors }} <br>
            {{ form.non_field_errors }}</p>
    </div>
</div>

</div>


</div>


<script>
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#blah')
                    .attr('src', e.target.result)
                    .width(200)
                    .height(200);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }

    function readURL11(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#blah11')
                    .attr('src', e.target.result)
                    .width(200)
                    .height(200);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }

    function readURL22(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();

            reader.onload = function (e) {
                $('#blah22')
                    .attr('src', e.target.result)
                    .width(200)
                    .height(200);
            };

            reader.readAsDataURL(input.files[0]);
        }
    }
</script>

<!-- croping of update product -->

<script>
    let result1 = document.querySelector('.result1'),
        save1 = document.querySelector('.save1'),
        cropped1 = document.querySelector('.imageview1'),
        upload1 = document.querySelector('#id_Images'),
        cropper1 = '';

    upload1.addEventListener('change', (e) => {
        var fileName = document.getElementById("id_Images").value;
        var idxDot = fileName.lastIndexOf(".") + 1;
        var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
        if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
            if (e.target.files.length) {
                // start file reader
                const reader = new FileReader();
                reader.onload = (e) => {
                    if (e.target.result) {
                        // create new image
                        $("#exampleModalCenter1").modal("show");
                        let img1 = document.createElement('img');
                        img1.id = 'image1';
                        img1.src = e.target.result
                        // clean result before
                        result1.innerHTML = '';
                        // append new image
                        result1.appendChild(img1);
                        // init cropper
                        cropper1 = new Cropper(img1, {
                            aspectRatio: 16 / 9,
                            viewMode: 2,
                        });
                    }
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        } else {
            swal("this file type is not supported", {
                icon: "error",
            })
            fileName = "";
            console.log(fileName)
        }
    });

    save1.addEventListener('click', (e) => {
        e.preventDefault();
        // get result to data uri
        let imgSrc1 = cropper1.getCroppedCanvas({
            width: 300,
            height: 500 // img disp value
        }).toDataURL();
        $("#exampleModalCenter1").modal("hide");
        imageview1.src = imgSrc1;
        $('#pro_img1').val(imgSrc1)
    });
</script>
<script>
    let result2 = document.querySelector('.result2'),
        save2 = document.querySelector('.save2'),
        cropped2 = document.querySelector('.imageview2'),
        upload2 = document.querySelector('#id_Images11'),
        cropper2 = '';

    upload2.addEventListener('change', (e) => {
        var fileName = document.getElementById("id_Images11").value;
        var idxDot = fileName.lastIndexOf(".") + 1;
        var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
        if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
            if (e.target.files.length) {
                // start file reader
                const reader = new FileReader();
                reader.onload = (e) => {
                    if (e.target.result) {
                        // create new image
                        $("#exampleModalCenter2").modal("show");
                        let img2 = document.createElement('img');
                        img2.id = 'image2';
                        img2.src = e.target.result;
                        // clean result before
                        result2.innerHTML = '';
                        // append new image
                        result2.appendChild(img2);
                        // init cropper
                        cropper2 = new Cropper(img2, {
                            aspectRatio: 16 / 9,
                            viewMode: 2,
                        });
                    }
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        } else {
            swal("this file type is not supported", {
                icon: "error",
            })
            fileName = "";
            console.log(fileName)
        }
    });

    save2.addEventListener('click', (e) => {
        e.preventDefault();
        // get result to data uri
        let imgSrc2 = cropper2.getCroppedCanvas({
            width: 300,
            height: 500 // img disp value
        }).toDataURL();
        $("#exampleModalCenter2").modal("hide");
        imageview2.src = imgSrc2;
        $('#pro_img2').val(imgSrc2)
    });
</script>
<script>
    let result3 = document.querySelector('.result3'),
        save3 = document.querySelector('.save3'),
        cropped3 = document.querySelector('.imageview3'),
        upload3 = document.querySelector('#id_Images22'),
        cropper3 = '';

    upload3.addEventListener('change', (e) => {
        var fileName = document.getElementById("id_Images22").value;
        var idxDot = fileName.lastIndexOf(".") + 1;
        var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
        if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
            if (e.target.files.length) {
                // start file reader
                const reader = new FileReader();
                reader.onload = (e) => {
                    if (e.target.result) {
                        // create new image
                        $("#exampleModalCenter3").modal("show");
                        let img3 = document.createElement('img');
                        img3.id = 'image3';
                        img3.src = e.target.result
                        // clean result before
                        result3.innerHTML = '';
                        // append new image
                        result3.appendChild(img3);
                        // init cropper
                        cropper3 = new Cropper(img3, {
                            aspectRatio: 16 / 9,
                            viewMode: 2,
                        });
                    }
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        } else {
            swal("this file type is not supported", {
                icon: "error",
            })
            fileName = "";
            console.log(fileName)
        }
    });

    save3.addEventListener('click', (e) => {
        e.preventDefault();
        // get result to data uri
        let imgSrc3 = cropper3.getCroppedCanvas({
            width: 300,
            height: 500 // img disp value
        }).toDataURL();
        $("#exampleModalCenter3").modal("hide");
        imageview3.src = imgSrc3;
        $('#pro_img3').val(imgSrc3)
    });
</script>





</body>

</html>

{% endblock %}